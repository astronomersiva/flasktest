<!DOCTYPE html>
<html lang="en">
<head>
  <title>{% if post.title %}{{ post.title }} | {% endif %}@siva</title>
  <meta property="og:title" content="{{ post.title }}" />
  <meta property="og:site_name" content="@siva" />
  <meta property="og:url" content="https://sivasubramanyam.me/{{ post.path }}" />
  <meta property="og:description" content="{{ post.description }}" />
  <meta name="twitter:card" content="{{ post.description }}" />
  <meta name="twitter:creator" content="@astronomersiva" />
  <meta name="description" content="{{ post.description }}" />

  {% include "head.html" %}

  {% if post.hero %}
    <style>
      .webp .hero-post, .hero-post {
        background-image: url('data:{{post.heroPlaceholder}}');
        transition: background 0.7s linear;
        {% if post.heroPosition %}
          background-position: {{post.heroPosition}}
        {% endif %}
      }

      {% if post.heroMobile %}
        @media screen and (max-width: 470px) {
          .webp .hero-post, .hero-post {
            background-image: url('data:{{post.heroPlaceholder}}');
          }
        }
      {% endif %}
    </style>
  {% endif %}

  <link href="/static/css/ajanta.css" rel="stylesheet" type="text/css">
  <noscript>
    <style>
      .old-lazy-load {
        display: none;
      }
    </style>
  </noscript>

  {% if post.code %}
    <link rel="stylesheet" href="/static/js/highlight/styles/shades-of-purple.css" type="text/css">
    <script src="/static/js/highlight/highlight.pack.js"></script>
  {% endif %}

  {% if post %}
    {% assign toPreload = post.imagesToPreload | split: ',' %}
    {% for asset in toPreload %}
      <link rel="preload" href="{{asset}}" as="image">
    {% endfor %}

    {% for tag in post.tags %}
      <link rel="prefetch" href="/tag/{{tag | downcase}}/">
    {% endfor %}
  {% endif %}
</head>
<body>
  {% include "navbar-posts.html" %}

  {% include "post-header.html" %}

  <main role="main">
    <div class="container posts narrow">
      <div class="content">
        {{ post.html }}
        <br>

        <div class="see-more" style="font-style: italic;">
          View Other Posts Tagged
          {% for tag in post.tags %}
            - <a href="/tag/{{tag | downcase}}">{{tag}}</a>
          {% endfor %}
        </div>
        <br>
      </div>
    </div>
  </main>

  {% include "footer.html" %}

  {% if post.code %}
    <script>
      const preTags = Array.from(document.getElementsByTagName('pre'));
      preTags.forEach((i, block) => {
        hljs.highlightBlock(i);
      });
    </script>
  {% endif %}

  {% if post.hero %}
    <script defer>
      let hero = '{{post.hero}}';
      let heroMobile = '{{post.heroMobile}}';

      let html = document.getElementsByTagName('html')[0];
      if (html.className.includes('webp')) {
        hero = hero.replace('.jpeg', '.webp').replace('.jpg', '.webp').replace('.png', '.webp');
        heroMobile = heroMobile.replace('.jpeg', '.webp').replace('.jpg', '.webp').replace('.png', '.webp');
      }

      let heroDiv = document.getElementsByClassName('hero-post')[0];
      if (window.innerWidth < 760) {
        hero = heroMobile;
      }

      let placeholderElement = new Image();
      placeholderElement.src = hero;

      placeholderElement.onload = function() {
        heroDiv.setAttribute('style', `background-image: url(${hero})`);
      }
    </script>
  {% endif %}
</body>
</html>
